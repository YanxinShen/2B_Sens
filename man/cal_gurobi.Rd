% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gurobi.R
\name{cal_gurobi}
\alias{cal_gurobi}
\title{Solve Quadratic Programming Problem Using Gurobi}
\usage{
cal_gurobi(
  Q,
  w,
  A,
  vec,
  N,
  ns,
  ns1,
  ns2,
  upper,
  lower,
  tstar,
  params = list(),
  quadcon = NULL,
  test = FALSE
)
}
\arguments{
\item{Q}{Matrix, the quadratic coefficient matrix for the objective function.}

\item{w}{Numeric vector, the linear coefficients for the objective function.}

\item{A}{Matrix, the constraint matrix defining equality and inequality constraints.}

\item{vec}{Numeric vector, typically representing predicted probabilities or propensity scores.}

\item{N}{Integer, the total number of observations.}

\item{ns}{Integer, the total number of groups in the matching structure.}

\item{ns1}{Integer, the total number of groups for \strong{one-to-one} and \strong{one-to-many} matching.}

\item{ns2}{Integer, the total number of groups for \strong{many-to-one} matching.}

\item{upper}{Numeric vector, the upper bounds for the decision variables.}

\item{lower}{Numeric vector, the lower bounds for the decision variables.}

\item{tstar}{Numeric, the test statistic for the current group.}

\item{params}{List, additional parameters for the Gurobi optimization solver.}

\item{quadcon}{List, optional quadratic constraints for the optimization problem (default is \code{NULL}).}

\item{test}{Logical (default is \code{FALSE}), whether to perform iterative testing with increasing \code{NumericFocus} parameter.}
}
\value{
A list containing:
\itemize{
\item \code{H0} - Hypothesis result (0 = accept null hypothesis, 1 = reject null hypothesis, \code{NA} if no solution is found).
\item \code{calculation} - Final objective value, representing the test statistic.
}
}
\description{
This function solves a quadratic programming problem using the Gurobi optimizer.
It is designed to evaluate hypotheses for sensitivity analysis in observational studies.
}
\details{
The function constructs a quadratic programming model and solves it using the Gurobi optimizer.
The optimization problem includes:
\itemize{
\item An objective function with quadratic (\code{Q}) and linear (\code{w}) terms.
\item Constraints defined by the matrix \code{A} and the bounds \code{upper} and \code{lower}.
\item Optional quadratic constraints (\code{quadcon}) for sensitivity analysis.
}

The function supports iterative testing with increasing \code{NumericFocus} values to improve solver robustness when \code{test = TRUE}.

The hypothesis result (\code{H0}) is determined based on:
\itemize{
\item If \code{ns2 == 0}: \code{calculation = result$objval + tstar^2}.
\item If \code{ns2 > 0}: \code{calculation = result$objval + sum(vec[(ns1 + 1):N])^2 + tstar^2 - 2 * tstar * sum(vec[(ns1 + 1):N])}.
}
\code{H0} is set to 0 if the calculation is less than or equal to 0, and 1 otherwise.
}
